#### Jetpack version

* Jetpack 6.1

#### Supported SENSING Camera Modules

* SG1-OX01F10C-GMSL-Hxxx

  * support max 6 cameras to light up at the same time
* SG2-AR0231-0202-GMSL-Hxxx

  * support max 6 cameras to light up at the same time

#### Quick Bring Up

1. Copy the driver package to the working directory of the Jetson device, such as “/home/nvidia”

   ```
   /home/nvidia/SG6C-ORNX-G2-F_OrinNX_OrinNano_YUV_GMSL1_JP6.1_L4TR36.4
   ```
2. Enter the driver directory

   ```
   cd SG6C-ORNX-G2-F_OrinNX_OrinNano_YUV_GMSL1_JP6.1_L4TR36.4
   ```
3. Grant execute permissions to all scripts, then run the "install.sh" script

   ```
   chmod a+x *.sh
   ./install.sh
   ```
4. Use the "sudo /opt/nvidia/jetson-io/jetson-io.py" command to select the corresponding device

   ```
   sudo /opt/nvidia/jetson-io/jetson-io.py

   1.select "Configure Jetson 24pin CSI Connector"
   2.select Configure for compatible hardware
   3.select "Jetson Sensing YUV GMSL1x6""
   4.select "Save pin changes"
   5.select "Save and reboot to reconfigure pins"
   ```
5. After the device reboots, install v4l-utils plugins, then enter the driver directory and run the script "load_module.sh".

   ```
   sudo apt update
   sudo apt-get install v4l-utils
   sudo ./load_module.sh
   ```
6. Bring up one camera

   ```
   # For SG2-AR0231C-0202-GMSL-Hxxxx

   ## CAM0
   v4l2-ctl -d /dev/video0 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video0 ! xvimagesink -ev

   ## CAM1
   v4l2-ctl -d /dev/video1 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video1 ! xvimagesink -ev

   ## CAM2
   v4l2-ctl -d /dev/video2 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video2 ! xvimagesink -ev

   ## CAM3
   v4l2-ctl -d /dev/video3 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video3 ! xvimagesink -ev

   ## CAM4
   v4l2-ctl -d /dev/video4 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video4 ! xvimagesink -ev

   # For SG1-OX01F10C-GMSL-Hxxxx
   ## CAM5
   v4l2-ctl -d /dev/video5 -c sensor_mode=0
   gst-launch-1.0 v4l2src device=/dev/video5 ! xvimagesink -ev
   ```  

#### Integration with SENSING Driver Source Code

1. Compile Image & dtb
   Refer to the following command to integrate Dtb and Kernel source code to your kernel

   ```
   cp camera-driver-package/source/hardware Linux_for_Tegra/source/hardware -r
   cp camera-driver-package/source/kernel Linux_for_Tegra/source/kernel -r
   cp camera-driver-package/source/nvidia-oot Linux_for_Tegra/source/nvidia-oot -r
   ```
2. Go to the root directory of your source code and recompile

   ```
   cd <install-path>/Linux_for_Tegra/source
   export CROSS_COMPILE_AARCH64=toolchain-path/bin/aarch64-buildroot-linux-gnu-
   export KERNEL_HEADERS=$PWD/kernel/kernel-jammy-src
   export INSTALL_MOD_PATH=<install-path>/Linux_for_Tegra/rootfs/
   make -C kernel
   make modules
   make dtbs
   sudo -E make install -C kernel

   cp kernel/kernel-jammy-src/arch/arm64/boot/Image <install-path>/Linux_for_Tegra/kernel/Image
   cp nvidia-oot/device-tree/platform/generic-dts/dtbs/* <install-path>/Linux_for_Tegra/kernel/dtb/
   ```
3. Install the newly generated Image and dtb to your nvidia device and reboot to let them take effect

   ```
   dtb:nvidia-oot/device-tree/platform/generic-dts/dtbs/
   Image: kernel/kernel-jammy-src/arch/arm64/boot/

   tegra-camera.ko:nvidia-oot/drivers/media/platform/tegra/camera/
   nvhost-nvcsi-t194.ko:nvidia-oot/drivers/video/tegra/host/nvcsi/
   ```
4. Copy the image,dtb,ko generated by the above compilation to the corresponding location of jetson

   ```
   sudo cp *.dtbo /boot/
   sudo cp Image /boot/Image
   sudo cp tegra-camera.ko /lib/modules/5.15.148-tegra/updates/drivers/media/platform/tegra/camera/
   sudo cp nvhost-nvcsi-t194.ko /lib/modules/5.15.148-tegra/updates/drivers/video/tegra/host/nvcsi/
   ```
5. Select the device tree you want to light

   ```
   sudo /opt/nvidia/jetson-io/jetson-io.py

   1.select "Configure Jetson 24pin CSI Connector"
   2.select Configure for compatible hardware
   3.select "Jetson Sensing YUV GMSLx4"
   4.select "Save pin changes"
   5.select "Save and reboot to reconfigure pins"
   ```
6. Install camera driver

   ```
   sudo insmod ./ko/sgx-yuv-gmsl.ko
   ```
7. Bring up the camera

   ```
   # For SG2-AR0231C-0202-GMSL-Hxxxx

   ## CAM0
   v4l2-ctl -d /dev/video0 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video0 ! xvimagesink -ev

   ## CAM1
   v4l2-ctl -d /dev/video1 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video1 ! xvimagesink -ev

   ## CAM2
   v4l2-ctl -d /dev/video2 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video2 ! xvimagesink -ev

   ## CAM3
   v4l2-ctl -d /dev/video3 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video3 ! xvimagesink -ev

   ## CAM4
   v4l2-ctl -d /dev/video4 -c sensor_mode=1
   gst-launch-1.0 v4l2src device=/dev/video4 ! xvimagesink -ev

   # For SG1-OX01F10C-GMSL-Hxxxx
   ## CAM5
   v4l2-ctl -d /dev/video5 -c sensor_mode=0
   gst-launch-1.0 v4l2src device=/dev/video5 ! xvimagesink -ev
   ```